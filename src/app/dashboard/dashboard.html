<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<mat-sidenav-container class="dashboard-container">

  <!-- Sidebar -->
  <mat-sidenav #sidenav mode="side" [(opened)]="isSidebarOpen" class="sidebar">
    <mat-toolbar color="primary">Dashboard</mat-toolbar>
    <mat-nav-list>
      <a mat-list-item href="#"><mat-icon>home</mat-icon> Home</a>

      <!-- Roles Expand -->
      <mat-expansion-panel *ngIf="isAdmin()">
  <mat-expansion-panel-header>
    <mat-panel-title>
      <mat-icon>account_balance</mat-icon> Role
    </mat-panel-title>
  </mat-expansion-panel-header>
  <mat-action-list>
    <a mat-list-item *ngFor="let role of roles">
      {{ role.roleName }}
    </a>
  </mat-action-list>
</mat-expansion-panel>

      <!-- Show nav items only if permission exists -->
      <a mat-list-item href="#" *ngIf="permissionsForUser.includes('bank')">
        <mat-icon>account_balance</mat-icon> Bank
      </a>
      <a mat-list-item href="#" *ngIf="permissionsForUser.includes('branch')">
        <mat-icon>apartment</mat-icon> Branch
      </a>
      <a mat-list-item href="#" *ngIf="permissionsForUser.includes('geography')">
        <mat-icon>public</mat-icon> Geography
      </a>

      <!-- Sidebar Logout -->
      <a mat-list-item (click)="logout()">
        <mat-icon>power_settings_new</mat-icon> Logout
      </a>
    </mat-nav-list>
  </mat-sidenav>

  <!-- Main Content -->
  <mat-sidenav-content class="content">

    <!-- Top Toolbar -->
    <mat-toolbar color="accent">
      <button mat-icon-button (click)="toggleSidebar()">
        <mat-icon>menu</mat-icon>
      </button>

      <span>Welcome {{username}}</span>
      <button mat-icon-button color="warn" (click)="logout()">
        <mat-icon>power_settings_new</mat-icon>
      </button>
    </mat-toolbar>

    <!-- Main content area -->
    <div class="main-content">
      <h2>Overview</h2>
      <p>This is your dashboard content area. Customize it as needed.</p>

      <!-- Role & User Selection -->
      <mat-card class="p-3 mt-3">
        <h3>Assign Permissions</h3>

        <!-- Select Role -->
        <mat-form-field appearance="fill" class="w-100">
          <mat-label>Select Role</mat-label>
          <mat-select [(ngModel)]="selectedRole" name="role" (selectionChange)="onRoleChange($event.value)">
            <mat-option *ngFor="let role of roles" [value]="role.roleId">
              {{ role.roleName }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Select User -->
        <mat-form-field appearance="fill" class="w-100" *ngIf="users.length > 0">
          <mat-label>Select User</mat-label>
          <mat-select [(ngModel)]="selectedUser" name="user">
            <mat-option *ngFor="let user of users" [value]="user.userName">
              {{ user.userName }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Permission Checkboxes -->
        <div class="mt-2">
          <mat-checkbox [(ngModel)]="permissions.bank" name="bank">Bank</mat-checkbox>
          <mat-checkbox [(ngModel)]="permissions.branch" name="branch">Branch</mat-checkbox>
          <mat-checkbox [(ngModel)]="permissions.geography" name="geography">Geography</mat-checkbox>
        </div>

        <!-- Assign Button -->
        <button mat-raised-button color="primary" class="mt-3" (click)="assignPermissions()">
          Assign Permissions
        </button>
        <br>
        <!-- Get Permissions by User -->
        <button mat-raised-button color="primary" class="mt-3" (click)="getPermissionsByUser(selectedUser)">Get
          Permissions</button>

        <!-- Show permissions only if available -->
        <div *ngIf="permissionsForUser.length > 0" class="mt-2">
          <h4>Permissions for {{selectedUser}}:</h4>
          <ul>
            <li *ngFor="let p of permissionsForUser">{{ p }}</li>
          </ul>
        </div>
      </mat-card>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>